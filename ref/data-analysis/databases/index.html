<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>data | ST</title> <meta name="author" content="Sean Trautman"/> <meta name="description" content="Intro to Data Analysis"/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/st-logo-transparent.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://straut12.github.io/ref/data-analysis/databases/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <div class="site-container"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">ST</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/"></a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Coding</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/ref/coding/git/">VScode Github</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/coding/bash/">Bash Shell</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/coding/python/">Python</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/coding/js/">JavaScript</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/coding/html/">Web HTML</a> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Data Analysis</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/ref/data-analysis/data-collection/">data collection</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/data-analysis/databases/">databases</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/data-analysis/basic-charting/">basic charting</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/data-analysis/data-visualization/">data visualization</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/data-analysis/ml/">machine learning</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/data-analysis/statistics/">notes</a> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Linux</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/ref/linux/linuxdistros/">Linux Options</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/linux/desktop/">Desktop Appearance</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/linux/software/">Installing SW</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/linux/sharing/">File Sharing</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/linux/vnc-ssh/">Remote vnc ssh</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/linux/terminal/">Terminal cli</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/linux/autostart/">Autostart systemd</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/linux/logs/">Logs</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/ref/linux/list/">List of SW to Install</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="site-body wrapper"> <aside class="site-sidebar" id="site-sidebar"> <nav class="toc"> <header><h4 class="toc__title">Table of Contents</h4></header> <ul class="toc__menu"> <li><a href="#influxdb-time-based">Influxdb (Time Based)</a></li> <li> <a href="#mariadb-sql">MariaDB (SQL)</a> <ul> <li><a href="#select">SELECT</a></li> </ul> </li> <li><a href="#ms-access-sql">MS Access (SQL)</a></li> </ul> </nav> </aside> <main> <div class="post"> <p class="post-description">Intro to Data Analysis</p> <article> <p><strong>Databases</strong></p> <p>Types of databases</p> <ul> <li>Relational db (SQL) has tables with rows/cols to store structured data. The tables are related to each other thru keys and you can join based on certain key/col(s) values.</li> <li>Non-relational may contain less structured data</li> <li>Time based db (influxdb). Optimized for storing/retrieving time based data.</li> </ul> <p><strong>Indexing</strong><br> An index is a data structure that improves the speed of data retrieval operations on a database table. You can create an index on one or more columns of a table, and the same column can have multiple indexes. Indexes do not have to be unique and often may have duplicate values.</p> <p>An index is created on a column(s) of a database table. When you create an index on a column, it creates another data structure which holds the reference to the data of the column. The index structure is then sorted, allowing a more efficient search to be performed on it. Indexes are used to quickly locate data without having to search every row in a database table every time a database table is accessed. They can be created or dropped with a database intact.</p> <p><strong>Primary Key</strong> A primary key is a type of (unique) index over one or more fields in a table with unique values for every single row in this table. There can only be one primary key in a table and it ensures each record in the table is unique. (unique key with the name PRIMARY) If no primary key is defined MySQL will use first unique key as primary key if there is one. It is useful for updating/deleting a specific record and creating relationships between tables. A primary key from one table can be used as a foreign key in another table to create a link between the two tables.</p> <h1 id="influxdb-time-based">Influxdb (Time Based)</h1> <p>Some database options</p> <ul> <li>influxdb (time series for monitoring measurements over time)</li> <li>mysql (relation based) Can be used to collect a set of measurements over varying conditions.</li> <li>Text, csv, excel file</li> <li>For time series data I usually use node-red (with its charting options) connected to influxdb<br> For experimental data I read a csv using Jupyter Notebook or dash plotted by plotly</li> </ul> <p><a href="https://www.influxdata.com/" target="_blank" rel="noopener noreferrer">Influxdb</a> is a time series database (the time stamp is automatically added to the data when storing). It does not require a schema so it is a quick and easy install for collecting data over time. Node-red can store data in the influxdb and retrieve data for charting. (port 8086 used for communication)</p> <ul> <li><a href="https://docs.influxdata.com/influxdb/v2.0/reference/key-concepts/design-principles/" target="_blank" rel="noopener noreferrer">Design Principles</a></li> <li><a href="https://docs.influxdata.com/influxdb/v2.0/reference/key-concepts/data-elements/" target="_blank" rel="noopener noreferrer">Explanation of Data Elements</a></li> </ul> <p>Field - used to store the data and is required (not indexed)<br> Tags - descriptions of the data (metadata). Indexed to make data retrieval faster. Not required but recommended.<br> Measurement - similar to a table</p> <p>Note - with ver 1.8+ there is an alternate query option called flux and it differs quite a bit from InfluxQL syntax. The advantage is that flux provides a lot more options for querying and analyzing data. Some examples in my node-red will use flux instead of InfluxQL.</p> <p>Installation <br> Add the InfluxDB repository key so the RPi package manager is allowed to search that repository. The key gets passed into the gpg program and de-armored. Then saved into the /usr/share/keyrings/ directory.<br> <code class="language-plaintext highlighter-rouge">curl https://repos.influxdata.com/influxdb.key | gpg --dearmor | sudo tee /usr/share/keyrings/influxdb-archive-keyring.gpg &gt;/dev/null</code><br> <code class="language-plaintext highlighter-rouge">lsb_release -cs</code><br> Add influxDB repository to the sources list using signed-by. lsb_release -cs will automatically fill in the RPi version.<br> <code class="language-plaintext highlighter-rouge">echo "deb [signed-by=/usr/share/keyrings/influxdb-archive-keyring.gpg] https://repos.influxdata.com/debian $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/influxdb.list</code></p> <p><code class="language-plaintext highlighter-rouge">sudo apt update</code> Update the package list. Should see influxdata added<br> Now install<br> <code class="language-plaintext highlighter-rouge">sudo apt install influxdb</code><br> <code class="language-plaintext highlighter-rouge">sudo systemctl unmask influxdb.service</code><br> <code class="language-plaintext highlighter-rouge">sudo systemctl enable influxdb </code><br> <code class="language-plaintext highlighter-rouge">sudo systemctl start influxdb</code><br> <code class="language-plaintext highlighter-rouge">journalctl -u influxdb</code></p> <p>unmask allows all/any attempts to start the service</p> <p>​For node-red to pull data you need to enable HTTP authentication. With HTTP authentication enabled InfluxDB also requires you to create at least one admin user before you can interact with the system. Enter the influx interface by typing influx at a command line and then create an admin user/pswd.</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">influx 
</span><span class="gp">CREATE USER admin WITH PASSWORD '&lt;passwd&gt;</span><span class="s1">' WITH ALL PRIVILEGES 
</span><span class="go">show users 
exit 
</span></code></pre></div></div> <p>Now edit configuration file to enable HTTP authentication.<br> <code class="language-plaintext highlighter-rouge">sudo nano /etc/influxdb/influxdb.conf</code><br> Set HTTP service enabled and address</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">[http] 
enabled = true 
flux-enabled = true 
bind-address = ":8086" 
</span></code></pre></div></div> <p>*Note - After restarting influxdb service you may get “Failed to connect” if trying to enter REPL. It may take 5-15sec to setup and allow you back in.<br> <code class="language-plaintext highlighter-rouge">sudo systemctl restart influxdb</code><br> <code class="language-plaintext highlighter-rouge">influx -username admin -password &lt;passwd&gt;</code></p> <p>Helpful commands</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>CREATE DATABASE mydb
<span class="go">(will use default retention policy that equals shard group duration of 7 days. Data will be deleted after 7 days. Shard group is compressed data, stored in a TSM file.)

To use a different retnetion policy ..
</span><span class="gp">&gt;</span><span class="w"> </span>CREATE DATABASE mydb WITH DURATION 26w <span class="o">(</span>default shard <span class="k">for</span> +6mo of data is 1w<span class="o">)</span> 
<span class="gp">&gt;</span><span class="w"> </span>CREATE DATABASE mydb WITH DURATION 2w REPLICATION 1 SHARD DURATION 1w 
<span class="go">
</span><span class="gp">&gt;</span><span class="w"> </span>DROP DATABASE mydb <span class="o">(</span>to delete<span class="o">)</span> 
<span class="gp">&gt;</span><span class="w"> </span>SHOW DATABASES 
<span class="gp">&gt;</span><span class="w"> </span>USE mydb 
<span class="gp">&gt;</span><span class="w"> </span>SHOW MEASUREMENTS 
<span class="gp">&gt;</span><span class="w"> </span>SHOW SERIES 
<span class="gp">&gt;</span><span class="w"> </span>SELECT <span class="k">*</span> FROM measurement-name 
<span class="gp">&gt;</span><span class="w"> </span>SELECT <span class="k">*</span> FROM temperature 
<span class="gp">&gt;</span><span class="w"> </span>SELECT <span class="k">*</span> FROM <span class="s2">"temp"</span> WHERE <span class="s2">"value"</span> <span class="o">&gt;</span> 0 
<span class="gp">&gt;</span><span class="w"> </span>SELECT count<span class="o">(</span><span class="k">*</span><span class="o">)</span> FROM temperature<span class="p">;</span> <span class="o">(</span>will show how many recoreds <span class="k">in </span>MEASUREMENT temperature<span class="o">)</span> 
</code></pre></div></div> <p>To use influx cli at command prompt<br> <code class="language-plaintext highlighter-rouge">influx -execute 'SHOW DATABASES'</code></p> <p>To delete data</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span>use mydb
<span class="gp">&gt;</span><span class="w"> </span>delete from mydb where <span class="nb">time</span> <span class="o">&gt;</span> 161798006580600 and <span class="nb">time</span> &lt; 161798007032600
<span class="gp">&gt;</span><span class="w"> </span>delete from mydb where <span class="nb">time</span> <span class="o">=</span> 1617980056650000
<span class="gp">&gt;</span><span class="w"> </span>delete from mydb where tag <span class="o">=</span> <span class="s1">'value'</span> 
<span class="go">
Retention Policy and Shard. To alter the autogen RP on a db (autogen is the default RP used in nodered influx node)
</span><span class="gp">&gt;</span><span class="w"> </span>use mydb 
<span class="gp">&gt;</span><span class="w"> </span>ALTER RETENTION POLICY autogen ON mydb DURATION 2w REPLICATION 1 SHARD DURATION 1w 
<span class="gp">&gt;</span><span class="w"> </span>show retention policies 
<span class="gp">&gt;</span><span class="w"> </span>show shard <span class="nb">groups</span> 
</code></pre></div></div> <p>Sharding - facilitates horizontal scaling, or scaling out (vs vertical scaling). Allow for faster processing. Default shard groups based on RP duration. <br> Retention Policy’s DURATION – Shard Group Duration <br> &lt; 2 days – 1 hour<br> &gt;= 2 days and &lt;= 6 months – 1 day<br> &gt; 6 months – 7 days</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">CREATE RETENTION POLICY "52weeks" ON "mydb" DURATION 52w REPLICATION 1 DEFAULT
</span></code></pre></div></div> <p>creates an RP called 52weeks that exists in “mydb” database. 52w keeps data for a DURATION of 52w and it’s the DEFAULT RP for the database.<br> For testing</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">CREATE RETENTION POLICY "1d" ON "mydb" DURATION 1d REPLICATION 1
</span></code></pre></div></div> <p>will keep data for 1 day. Have 1 day to get the testing data retrieved and saved offline in a spreadsheet.</p> <p>To export a database/table(measurement) to a csv file<br> <code class="language-plaintext highlighter-rouge">influx -database 'database name' -execute "SELECT * FROM measurement" -format csv &gt; test.csv</code></p> <p>To backup/restore data<br> <code class="language-plaintext highlighter-rouge">sudo -u influxdb influxd backup -portable -host &lt;IPadd&gt;:8088 /path/to/backup/</code><br> <code class="language-plaintext highlighter-rouge">sudo -u influxdb influxd restore -portable -host &lt;IPadd&gt;:8088 /path/to/backup/</code></p> <p>To change the location where your data is stored<br> Create data and meta folders in the newlocation<br> Make influxdb owner of these new locations<br> <code class="language-plaintext highlighter-rouge">sudo chown -R influxdb:influxdb newlocation/influxdb/meta/</code><br> <code class="language-plaintext highlighter-rouge">sudo chown -R influxdb:influxdb newlocation/influxdb/data/</code><br> Update permission<br> <code class="language-plaintext highlighter-rouge">sudo chmod 777 -R data</code><br> <code class="language-plaintext highlighter-rouge">sudo chmod 777 -R meta</code></p> <p>changed folders in /etc/influxdb/influxdb.conf to /home/pi/influxdb (data and meta) along with IP address and under [http] at bottom enable=true for endpoint and bind-address = 8086</p> <h1 id="mariadb-sql">MariaDB (SQL)</h1> <p>Mariadb is based on mysql. Port 3306</p> <blockquote> <p>Note for remote connection from excel. Will need to configure mariadab config file by commenting out bind statement and add user privileges to all db and wild card host (see comments below). Also may need to install ODBC (Open DataBase Connectivity) connector from https://dev.mysql.com/downloads/connector/odbc/ and visual studio update. Then search/open up ODBC 64bit administrator and add MySQL ODBC 8.0 ANSI driver. Set up the connection and chose SQL server authentication.</p> </blockquote> <p>Run sudo apt update to update the package list</p> <ul> <li><code class="language-plaintext highlighter-rouge">sudo apt update</code></li> <li><code class="language-plaintext highlighter-rouge">sudo apt install mariadb-server</code></li> <li> <code class="language-plaintext highlighter-rouge">sudo mysql_secure_installation</code> utility<br> (options to allow for remote access on port 3306)<br> *<code class="language-plaintext highlighter-rouge">sudo mysql -u root -p</code> </li> <li><code class="language-plaintext highlighter-rouge">sudo ufw allow mysql</code></li> <li><code class="language-plaintext highlighter-rouge">sudo systemctl start mysql</code></li> <li> <code class="language-plaintext highlighter-rouge">sudo systemctl enable mysql</code><br> Config file is at /etc/mysql/mysql.conf.d/mysqld.cnf</li> </ul> <p>If you don’t run as sudo then the first time you get “MySQL ERROR” then run as sudo</p> <ul> <li> <code class="language-plaintext highlighter-rouge">$ sudo mysql</code><br> Then run alter command at mysql prompt<br> <code class="language-plaintext highlighter-rouge">sql mysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'your_new_password';</code><br> CTRL-D to exit</li> </ul> <p>Create a db with <code class="language-plaintext highlighter-rouge">CREATE DATABASE name;</code><br> Then create a user and privileges<br> <code class="language-plaintext highlighter-rouge">CREATE USER 'username'@'localhost' IDENTIFIED BY 'password';</code></p> <p><code class="language-plaintext highlighter-rouge">GRANT ALL PRIVILEGES ON &lt;dbname&gt;.* TO 'username'@'localhost';</code><br> <code class="language-plaintext highlighter-rouge">FLUSH PRIVILEGES;</code></p> <p>Can check user login with same <code class="language-plaintext highlighter-rouge">sudo mysql -u user -p</code><br> To see users<br> <code class="language-plaintext highlighter-rouge">SELECT User, Host FROM mysql.user WHERE Host &lt;&gt; 'localhost';</code></p> <p>To grant remote access you wild card all db with * and use % to wild card IP addresses<br> <code class="language-plaintext highlighter-rouge">GRANT ALL PRIVILEGES ON *.* TO 'sj4u'@'192.168.100.%' IDENTIFIED BY 'password' WITH GRANT OPTION;</code></p> <p>To see grants for a specific user<br> <code class="language-plaintext highlighter-rouge">SHOW GRANTS FOR CURRENT_USER</code><br> <code class="language-plaintext highlighter-rouge">SHOW GRANTS FOR 'user'@'localhost'</code></p> <p><strong>note</strong> When creating a new database I found I had to still grant privileges to the user for that specific database.</p> <p>Firewall config</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">firewall config  
firewall-cmd --add-port=3306/tcp 
firewall-cmd --permanent --add-port=3306/tcp
</span></code></pre></div></div> <p>Configuration file is in /etc/mysql/mariadb.conf.d/50-server.cnf<br> for remote access may need to update bind-address from 127.0.0.1 to 0.0.0.0 or comment it out<br> and add</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">skip-networking
skip-bind-address
</span></code></pre></div></div> <p>and restart with <code class="language-plaintext highlighter-rouge">sudo systemctl restart mysql.service</code><br> can see starting param with <code class="language-plaintext highlighter-rouge">mysqld --print-defaults</code></p> <p>or install PHPMyAdmin<br> <code class="language-plaintext highlighter-rouge">sudo apt install php libapache2-mod-php</code><br> <code class="language-plaintext highlighter-rouge">sudo apt install phpmyadmin</code><br> Select apache web server and say No to config with dbconfig-common</p> <p>Go to http://RPi-IPAddress/phpmyadmin<br> if you need to restart the server use <code class="language-plaintext highlighter-rouge">sudo service apache2 restart</code></p> <blockquote> <p>Test connection with <code class="language-plaintext highlighter-rouge">mysql --host=localhost --password='password' --protocol=tcp --port=3306 esp2nred </code></p> </blockquote> <p>Common mysql commands</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">SHOW DATABASES;</span><span class="w">
</span><span class="gp">USE &lt;database&gt;</span><span class="p">;</span>
<span class="gp">SHOW TABLES;</span><span class="w">
</span><span class="gp">SELECT * FROM &lt;table&gt;</span><span class="p">;</span>
<span class="go">UPDATE, INSERT, DELETE```

To import a csv (can also save a xls file as csv)  
Create a database and empty table with fields then import with the LOAD command.  
--local-infile may be needed  
</span><span class="gp">* ```$</span><span class="w"> </span>mysql <span class="nt">-u</span> root <span class="nt">-p</span> <span class="nt">--local-infile</span><span class="sb">```</span>  
<span class="go">```sql
</span><span class="gp">mysql&gt;</span><span class="w"> </span>CREATE DATABASE testdb<span class="p">;</span>
<span class="gp">mysql&gt;</span><span class="w"> </span>USE testdb<span class="p">;</span>
</code></pre></div></div> <p>Create the table/define schema using options below<br> A good example is in node-red</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">mytable</span> <span class="p">(</span>
<span class="s1">'no'</span> <span class="nb">INT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="s1">'date'</span> <span class="nb">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<span class="n">field1</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<span class="n">field2</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<span class="n">field3</span> <span class="nb">INT</span><span class="p">,</span>
<span class="n">field4</span> <span class="nb">FLOAT</span><span class="p">,</span>
<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="k">no</span><span class="p">),</span>
<span class="k">INDEX</span> <span class="n">idx_field</span> <span class="p">(</span><span class="n">field2</span><span class="p">));</span>
</code></pre></div></div> <p>Now import the data with LOAD</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">LOAD</span> <span class="k">DATA</span> <span class="k">LOCAL</span> <span class="n">INFILE</span> <span class="nv">"/path/to/data.csv"</span> <span class="k">INTO</span> <span class="k">TABLE</span> <span class="n">testdb</span><span class="p">.</span><span class="n">mytable</span> <span class="n">FIELDS</span> <span class="n">TERMINATED</span> <span class="k">BY</span> <span class="s1">','</span> <span class="n">LINES</span> <span class="n">TERMINATED</span> <span class="k">BY</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span> <span class="k">IGNORE</span> <span class="mi">1</span> <span class="n">LINES</span> <span class="p">(</span><span class="n">field1</span><span class="p">,</span> <span class="n">field2</span><span class="p">,</span> <span class="o">@</span><span class="n">field3</span><span class="p">,</span> <span class="n">field4</span><span class="p">)</span> <span class="k">set</span> <span class="n">field3</span> <span class="o">=</span> <span class="n">NOW</span><span class="p">();</span>
</code></pre></div></div> <p>Description:<br> column_name data_type(length) [NOT NULL] [DEFAULT value] [AUTO_INCREMENT] column_constraint;</p> <ul> <li>column_name</li> <li>data type and optional size VARCHAR(255)</li> <li>NOT NULL ensures the column will not contain NULL. Other options are CHECK and UNIQUE.</li> <li>DEFAULT is default value for the column.</li> <li>AUTO_INCREMENT col is incremented by one automatically whenever new row is inserted. Each table can only have one AUTO_INCREMENT column.</li> <li>After the column list can define table constraints like UNIQUE, CHECK, PRIMARY KEY and FOREIGN KEY.</li> </ul> <p>To verify</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">mytable</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">field1</span><span class="p">;</span>
</code></pre></div></div> <p>or</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">mytable</span> <span class="k">limit</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div></div> <p>Create an index</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">CREATE INDEX index_name
</span><span class="gp">ON table_name (column1, column2, ...);</span><span class="w">
</span></code></pre></div></div> <h2 id="select">SELECT</h2> <p>SELECT ‘columns to return’ FROM a database</p> <ul> <li>SELECT table.col1, table.col2 ..</li> <li>Can use DISTINCT after SELECT for distinct values</li> <li>Can use ORDER BY to sort the data</li> </ul> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">SELECT * FROM `esp2nred`.`data` ORDER BY date DESC LIMIT 20;</span><span class="w">
</span></code></pre></div></div> <p>WHERE is a search condition used to limit the number of rows returned</p> <ul> <li>WHERE expression OPERATOR expression</li> <li>WHERE humidity &gt; 50</li> <li>WHERE device = ‘esp32’</li> <li>Can use wildcards</li> <li>WHERE device LIKE ‘%esp%’</li> </ul> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">SELECT * FROM `esp2nred`.`data` WHERE humidity &gt;</span><span class="w"> </span>50<span class="p">;</span>
</code></pre></div></div> <p>JOIN is used to combine multiple tables based on a related column between them.</p> <ul> <li>INNER only returns rows when there is a match between the columns</li> <li>LEFT returns all rows from left and matching records from right</li> <li>RIGHT returns all rows from right and matching records from left</li> <li>FULL returns all matching records from both tables whether the other table matches or not</li> </ul> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">SELECT * FROM esp2nred.data INNER JOIN rpi2nred.data ON esp2nred.data.device=rpi2nred.data.device AND esp2nred.data.location=rpi2nred.data.location;</span><span class="w">
</span></code></pre></div></div> <p>To update a value in a column. Example below replaces “ with a space</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">UPDATE table SET colA =  REPLACE(colA, '\"', '');</span><span class="w">
</span></code></pre></div></div> <h1 id="ms-access-sql">MS Access (SQL)</h1> <p>Access makes importing data into excel convenient. You can use PowerQuery to import sheets and transform them. You can also modify tables (add col/rows) with append/merge using the gui and drop down menus vs writing a query.</p> <div class="row"> <div class="col-md mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/coding/msaccess-query.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </article> </div> </main> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Sean Trautman. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>